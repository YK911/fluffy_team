{"version":3,"file":"index.js","sources":["../src/js/server-api.js","../src/js/refs.js","../src/js/pets-list-section.js"],"sourcesContent":["import axios from \"axios\";\n\nexport const BASE_URL = 'https://paw-hut.b.goit.study/api';\nexport const ENDPOINTS = {\n    animals: '/animals',\n    categories: '/categories',\n    orders: '/orders',\n    feedbacks: '/feedbacks',\n};\n\nexport const server = axios.create({\n    baseURL: BASE_URL,\n})\n\n\n","export const refs = {\n    categoryList: document.querySelector('.js-category-list'),\n    petsList: document.querySelector('.js-pets-list'),\n    loader: document.querySelector('.js-loader'),\n    petsLoadMoreBtn: document.querySelector('.js-pets-load-more-btn')\n}","import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport { ENDPOINTS, server } from \"./server-api\";\nimport { refs } from \"./refs\";\n\nlet limit = getLimitByScreen();\nlet page = 1;\nlet totalItems;\nlet categoryId;\n\ndocument.addEventListener('DOMContentLoaded', handleContentLoad);\nrefs.petsLoadMoreBtn.addEventListener('click', handleLoadMoreBtnClick);\nrefs.categoryList.addEventListener('click', handleCategoryBtnClick);\n\n\nfunction getLimitByScreen() {\n  const width = window.innerWidth;\n\n  if (width >= 1440) return 9;     \n  return 8;                      \n}\n\n\n// --------------- handlers -------------------\n\nasync function handleContentLoad(e) {\n    showLoader();\n    \n    try {\n        const categories = await fetchAllCategories();\n        const animals = await fetchAllAnimals();   \n        \n        renderCategories(categories);\n        renderAnimals(animals);\n\n        checkLoadMoreBtnStatus();\n    } catch (error) {\n       console.log(error);\n    } finally {\n        hideLoader();\n    }\n}\n\n\nasync function handleCategoryBtnClick(e) {\n    if (e.target.nodeName !== 'BUTTON') return;\n    const categoryName = e.target.textContent;\n    const categoryLi = e.target.closest('li');\n    categoryId = categoryLi.dataset.id; \n    page = 1;\n    showLoader();\n\n    const allButtons = refs.categoryList.querySelectorAll('.category-btn');\n    allButtons.forEach(btn => {\n        btn.classList.remove('current');\n    });\n\n    e.target.classList.add('current');\n\n    try {\n        let animals = await fetchAllAnimals();\n        if (categoryName !== 'Всі') {\n            animals = await fetchCategoryById(categoryId, page);\n        }\n        renderAnimals(animals);    \n        checkLoadMoreBtnStatus(); \n    } catch (error) {\n        iziToast.error({\n            title: 'Помилка',\n            message: 'Щось пішло не так',\n            position: 'topRight',\n        })\n        throw error;\n    } finally {\n        hideLoader();\n    }\n}\n\n\nasync function handleLoadMoreBtnClick() {\n    page += 1;\n\n    refs.loader.classList.add('loader-center');\n    showLoader();\n\n    try {\n        if (!categoryId) {\n            checkLoadMoreBtnStatus();\n            const animals = await fetchAllAnimals(page);\n            const markup = animalsTemplate(animals);\n            refs.petsList.insertAdjacentHTML('beforeend', markup);\n        } else {\n            checkLoadMoreBtnStatus();\n            const animals = await fetchCategoryById(categoryId, page);\n            const markup = animalsTemplate(animals);\n            refs.petsList.insertAdjacentHTML('beforeend', markup);\n        }\n\n        const firstCard = refs.petsList.querySelector('li');\n        if (firstCard) {\n            const cardRect = firstCard.getBoundingClientRect();\n            window.scrollBy({\n                top: cardRect.height, \n                behavior: 'smooth',\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Помилка',\n            message: 'Щось пішло не так',\n            position: 'topRight',\n        })\n        throw error;\n    } finally {\n        hideLoader(); \n        refs.loader.classList.remove('loader-center');\n    }  \n}\n\n\n// ----------------- API -----------------\n\nasync function fetchAllCategories(page) {\n    try {\n    const response = await server.get(`${ENDPOINTS.categories}`);   \n    return response.data;\n    } catch (error) {\n        iziToast.error({\n            title: 'Помилка',\n            message: 'Щось пішло не так',\n            position: 'topRight',\n        })\n        throw error;\n    }\n}\n\nasync function fetchAllAnimals() {\n    try {\n        const response = await server.get(`${ENDPOINTS.animals}`, {\n            params: {\n                limit: limit,\n                page: page\n            }\n        });\n\n        totalItems = response.data.totalItems;\n        return response.data.animals; \n        \n    } catch (error) {\n        iziToast.error({\n            title: 'Помилка',\n            message: 'Щось пішло не так',\n            position: 'topRight',\n        })\n        throw error;\n    }   \n}\n\nasync function fetchCategoryById(id, page) {\n    try {\n        const response = await server.get(`${ENDPOINTS.animals}?categoryId=${id}`, {\n            params: {\n            limit: limit,\n            page: page\n            }\n        });\n        totalItems = response.data.totalItems;\n        return response.data.animals;\n        \n    } catch (error) {\n            iziToast.error({\n            title: 'Помилка',\n            message: 'Щось пішло не так',\n            position: 'topRight',\n        })\n        throw error;\n    }\n}\n\n\n\n// ----------------- render -----------------\n\nfunction categoryTemplate(category) {\n    return `\n     <li class=\"category-item\" data-id=\"${category._id}\">\n        <button class=\"category-btn\" type=\"button\">${category.name}</button>\n      </li>`\n}\n\nfunction categoriesTemplate(categories) {\n    return categories.reverse().map(categoryTemplate).join('');\n}\n\nfunction renderCategories(categories) {\n    const markup =` <li class=\"category-item\">\n        <button class=\"category-btn current\" type=\"button\">Всі</button>\n      </li>${categoriesTemplate(categories)}`;\n\n    refs.categoryList.innerHTML = markup;  \n}\n\nfunction animalTemplate({ _id, name, image, species, age, gender, categories, description }) {\n    const categoriesMarkup = categories\n        .map(category => `<li class=\"pets-category-item\">${category.name}</li>`)\n        .join('');\n    \n    return `\n     <li class=\"pets-item\" data-id=\"${_id}\">\n        <img class=\"pets-img\" src=\"${image}\" alt=\"${name} - ${species}\" />\n        <div class=\"pets-list-wrapper\">\n          <p class=\"pets-category\">${species}</p>\n          <h3 class=\"pets-name\">${name}</h3>\n          <ul class=\"pets-category-list\">${categoriesMarkup}</ul>\n          <div class=\"descriprion-wrapper\">\n            <ul class=\"descriprion-list\">\n              <li class=\"descriprion-item\">${age}</li>\n              <li class=\"descriprion-item\">${gender}</li>\n            </ul>\n            <p class=\"pets-descriprion\">${description}</p>\n            <button class=\"pets-button\" type=\"button\">Дізнатись більше</button>\n          </div>\n        </div>\n      </li>`\n}\n\nfunction animalsTemplate(animals) {\n    return animals.map(animalTemplate).join('');\n}\n\nfunction renderAnimals(animals) {\n    const markup = animalsTemplate(animals);\n    refs.petsList.innerHTML = markup;\n}\n\n// --------------- loader ---------------\n\nfunction showLoader() {\n    refs.loader.classList.remove('loader-hidden');\n}\n\nfunction hideLoader() {\n    refs.loader.classList.add('loader-hidden');\n}\n\n\n// --------------- load more btn ---------------\n\nfunction showLoadBtn() {\n    refs.petsLoadMoreBtn.classList.remove('pets-load-more-btn-hidden')\n}\n\nfunction hideLoadBtn() {\n    refs.petsLoadMoreBtn.classList.add('pets-load-more-btn-hidden')\n}\n\nfunction checkLoadMoreBtnStatus() {\n    const totalPages = Math.ceil(totalItems / limit);\n      if (page >= totalPages) {\n        hideLoadBtn();\n    } else {\n        showLoadBtn();\n    }\n}\n\n\n"],"names":["BASE_URL","ENDPOINTS","server","axios","refs","limit","getLimitByScreen","page","totalItems","categoryId","handleContentLoad","handleLoadMoreBtnClick","handleCategoryBtnClick","e","showLoader","categories","fetchAllCategories","animals","fetchAllAnimals","renderCategories","renderAnimals","checkLoadMoreBtnStatus","error","hideLoader","categoryName","btn","fetchCategoryById","iziToast","markup","animalsTemplate","firstCard","cardRect","response","id","categoryTemplate","category","categoriesTemplate","animalTemplate","_id","name","image","species","age","gender","description","categoriesMarkup","showLoadBtn","hideLoadBtn","totalPages"],"mappings":"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"}